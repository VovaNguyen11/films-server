{"ast":null,"code":"var _jsxFileName = \"/Users/vovanguyen/Desktop/bt/films_server/client/src/components/forms/FilmForm.js\";\nimport React, { Component } from \"react\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport ReactImageFallback from \"react-image-fallback\";\nimport FormMessage from \"./FormMessage\";\nconst initData = {\n  _id: null,\n  title: \"\",\n  img: \"\",\n  director: \"\",\n  description: \"\",\n  duration: \"\",\n  price: \"\",\n  featured: false\n};\n\nclass FilmForm extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: initData,\n      errors: {},\n      isLoading: false,\n      redirect: false\n    };\n\n    this.handleStringChange = ({\n      target\n    }) => this.setState({\n      data: { ...this.state.data,\n        [target.name]: target.value\n      },\n      errors: { ...this.state.errors,\n        [target.name]: \"\"\n      }\n    });\n\n    this.handleNumberChange = ({\n      target\n    }) => {\n      const val = target.value.replace(/\\D/g, \"\");\n      this.setState({\n        data: { ...this.state.data,\n          [target.name]: Number(val)\n        },\n        errors: { ...this.state.errors,\n          [target.name]: \"\"\n        }\n      });\n    };\n\n    this.handleCheckboxChange = ({\n      target\n    }) => this.setState({\n      data: { ...this.state.data,\n        [target.name]: target.checked\n      }\n    });\n\n    this.validate = data => {\n      const errors = {};\n      if (!data.title) errors.title = \"title cannot be blank\";\n      if (!data.description) errors.description = \"Description cannot be blank\";\n      if (!data.director) errors.director = \"Director cannot be blank\";\n      if (!data.img) errors.img = \"Image cannot be blank\";\n      if (!data.duration) errors.duration = \"Duration cannot be blank\";\n      if (!data.price) errors.price = \"Price cannot be blank\";\n\n      if (parseInt(data.duration) < 1) {\n        errors.duration = \"Duration cannot be negative value\";\n      }\n\n      if (parseFloat(data.price) <= 0) {\n        errors.price = \"Price cannot be negative value\";\n      }\n\n      return errors;\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      const errors = this.validate(this.state.data);\n      this.setState({\n        errors\n      });\n\n      if (Object.keys(errors).length === 0) {\n        this.setState({\n          isLoading: true\n        });\n        this.props.saveFilm(this.state.data).then(() => this.setState({\n          redirect: true\n        })).catch(err => this.setState({\n          errors: err.response.data.errors,\n          isLoading: false\n        }));\n        this.setState({\n          data: initData\n        });\n      }\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.film._id) {\n      this.setState({\n        data: this.props.film\n      });\n    }\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const {\n      film\n    } = props;\n    const {\n      data\n    } = state;\n\n    if (film._id && film._id !== data._id) {\n      return {\n        data: film,\n        errors: {}\n      };\n    }\n\n    if (!film._id && data._id !== null) {\n      return {\n        data: initData,\n        errors: {}\n      };\n    }\n\n    return null;\n  }\n\n  render() {\n    const {\n      data,\n      errors,\n      isLoading,\n      redirect\n    } = this.state;\n    return React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      className: `ui form ${isLoading ? \"loading\" : \"\"}`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, redirect && React.createElement(Redirect, {\n      to: \"/films\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"ui  grid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"twelve wide column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: errors.title ? \"field error\" : \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, \"Film title\"), React.createElement(\"input\", {\n      value: data.title,\n      onChange: this.handleStringChange,\n      type: \"text\",\n      name: \"title\",\n      id: \"name\",\n      placeholder: \"film title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }), React.createElement(FormMessage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, errors.title)), React.createElement(\"div\", {\n      className: errors.description ? \"field error\" : \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, \"Film description\"), React.createElement(\"textarea\", {\n      value: data.description,\n      onChange: this.handleStringChange,\n      name: \"description\",\n      id: \"description\",\n      placeholder: \"film description\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), React.createElement(FormMessage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, errors.description))), React.createElement(\"div\", {\n      className: \"four wide column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, React.createElement(ReactImageFallback, {\n      src: data.img,\n      fallbackImage: \"http://via.placeholder.com/250x250\",\n      alt: data.title,\n      className: \"ui image\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"twelve wide column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: errors.img ? \"field error\" : \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, \"Image\"), React.createElement(\"input\", {\n      value: data.img,\n      onChange: this.handleStringChange,\n      type: \"text\",\n      name: \"img\",\n      id: \"img\",\n      placeholder: \"img\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }), React.createElement(FormMessage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, errors.img))), React.createElement(\"div\", {\n      className: \"six wide column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: errors.director ? \"field error\" : \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, \"Director\"), React.createElement(\"input\", {\n      value: data.director,\n      onChange: this.handleStringChange,\n      type: \"text\",\n      name: \"director\",\n      id: \"director\",\n      placeholder: \"film director\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(FormMessage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, errors.director))), React.createElement(\"div\", {\n      className: \"six wide column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: errors.duration ? \"field error\" : \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, \"Duration\"), React.createElement(\"input\", {\n      value: data.duration,\n      onChange: this.handleNumberChange,\n      type: \"number\",\n      name: \"duration\",\n      id: \"duration\",\n      placeholder: \"Duration\",\n      min: 0,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }), React.createElement(FormMessage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, errors.duration))), React.createElement(\"div\", {\n      className: \"six wide column\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: errors.price ? \"field error\" : \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, \"Price\"), React.createElement(\"input\", {\n      value: data.price,\n      onChange: this.handleNumberChange,\n      type: \"number\",\n      name: \"price\",\n      id: \"price\",\n      placeholder: \"price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }), React.createElement(FormMessage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, errors.price))), React.createElement(\"div\", {\n      className: \"six wide column inline field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"featured\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, \"Featured\"), React.createElement(\"input\", {\n      onChange: this.handleCheckboxChange,\n      value: data.featured,\n      type: \"checkbox\",\n      name: \"featured\",\n      id: \"featured\",\n      checked: data.featured,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"ui fluid buttons px-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"ui button primary\",\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, \"Save\"), React.createElement(\"div\", {\n      className: \"or\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247\n      },\n      __self: this\n    }), React.createElement(Link, {\n      className: \"ui button\",\n      to: \"/films\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248\n      },\n      __self: this\n    }, \"Hide form\")));\n  }\n\n}\n\nexport default FilmForm;","map":{"version":3,"sources":["/Users/vovanguyen/Desktop/bt/films_server/client/src/components/forms/FilmForm.js"],"names":["React","Component","Link","Redirect","ReactImageFallback","FormMessage","initData","_id","title","img","director","description","duration","price","featured","FilmForm","state","data","errors","isLoading","redirect","handleStringChange","target","setState","name","value","handleNumberChange","val","replace","Number","handleCheckboxChange","checked","validate","parseInt","parseFloat","handleSubmit","e","preventDefault","Object","keys","length","props","saveFilm","then","catch","err","response","componentDidMount","film","getDerivedStateFromProps","render"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\"\nimport {Link, Redirect} from \"react-router-dom\"\nimport ReactImageFallback from \"react-image-fallback\"\nimport FormMessage from \"./FormMessage\"\n\nconst initData = {\n  _id: null,\n  title: \"\",\n  img: \"\",\n  director: \"\",\n  description: \"\",\n  duration: \"\",\n  price: \"\",\n  featured: false,\n}\n\nclass FilmForm extends Component {\n  state = {\n    data: initData,\n    errors: {},\n    isLoading: false,\n    redirect: false,\n  }\n\n  componentDidMount() {\n    if (this.props.film._id) {\n      this.setState({data: this.props.film})\n    }\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const {film} = props\n    const {data} = state\n    if (film._id && film._id !== data._id) {\n      return {\n        data: film,\n        errors: {},\n      }\n    }\n    if (!film._id && data._id !== null) {\n      return {\n        data: initData,\n        errors: {},\n      }\n    }\n    return null\n  }\n\n  handleStringChange = ({target}) =>\n    this.setState({\n      data: {...this.state.data, [target.name]: target.value},\n      errors: {...this.state.errors, [target.name]: \"\"},\n    })\n\n  handleNumberChange = ({target}) => {\n    const val = target.value.replace(/\\D/g, \"\")\n    this.setState({\n      data: {...this.state.data, [target.name]: Number(val)},\n      errors: {...this.state.errors, [target.name]: \"\"},\n    })\n  }\n\n  handleCheckboxChange = ({target}) =>\n    this.setState({\n      data: {...this.state.data, [target.name]: target.checked},\n    })\n\n  validate = data => {\n    const errors = {}\n    if (!data.title) errors.title = \"title cannot be blank\"\n    if (!data.description) errors.description = \"Description cannot be blank\"\n    if (!data.director) errors.director = \"Director cannot be blank\"\n    if (!data.img) errors.img = \"Image cannot be blank\"\n    if (!data.duration) errors.duration = \"Duration cannot be blank\"\n    if (!data.price) errors.price = \"Price cannot be blank\"\n\n    if (parseInt(data.duration) < 1) {\n      errors.duration = \"Duration cannot be negative value\"\n    }\n\n    if (parseFloat(data.price) <= 0) {\n      errors.price = \"Price cannot be negative value\"\n    }\n    return errors\n  }\n\n  handleSubmit = e => {\n    e.preventDefault()\n    const errors = this.validate(this.state.data)\n    this.setState({errors})\n\n    if (Object.keys(errors).length === 0) {\n      this.setState({isLoading: true})\n      this.props\n        .saveFilm(this.state.data)\n        .then(() => this.setState({redirect: true}))\n        .catch(err =>\n          this.setState({errors: err.response.data.errors, isLoading: false}),\n        )\n      this.setState({data: initData})\n    }\n  }\n\n  render() {\n    const {data, errors, isLoading, redirect} = this.state\n    return (\n      <form\n        onSubmit={this.handleSubmit}\n        className={`ui form ${isLoading ? \"loading\" : \"\"}`}\n      >\n        {redirect && <Redirect to=\"/films\" />}\n        {/* ui grid START */}\n        <div className=\"ui  grid\">\n          <div className=\"twelve wide column\">\n            {/* Title START  */}\n            <div className={errors.title ? \"field error\" : \"field\"}>\n              <label>Film title</label>\n              <input\n                value={data.title}\n                onChange={this.handleStringChange}\n                type=\"text\"\n                name=\"title\"\n                id=\"name\"\n                placeholder=\"film title\"\n              />\n              <FormMessage>{errors.title}</FormMessage>\n            </div>\n            {/* Title END  */}\n\n            {/* Description START  */}\n            <div className={errors.description ? \"field error\" : \"field\"}>\n              <label>Film description</label>\n              <textarea\n                value={data.description}\n                onChange={this.handleStringChange}\n                name=\"description\"\n                id=\"description\"\n                placeholder=\"film description\"\n              ></textarea>\n              <FormMessage>{errors.description}</FormMessage>\n            </div>\n            {/* Description END  */}\n          </div>\n\n          {/* Image START \n          \"http://via.placeholder.com/250x250\"\n          */}\n          <div className=\"four wide column\">\n            <ReactImageFallback\n              src={data.img}\n              fallbackImage=\"http://via.placeholder.com/250x250\"\n              alt={data.title}\n              className=\"ui image\"\n            />\n          </div>\n\n          <div className=\"twelve wide column\">\n            <div className={errors.img ? \"field error\" : \"field\"}>\n              <label>Image</label>\n              <input\n                value={data.img}\n                onChange={this.handleStringChange}\n                type=\"text\"\n                name=\"img\"\n                id=\"img\"\n                placeholder=\"img\"\n              />\n              <FormMessage>{errors.img}</FormMessage>\n            </div>\n          </div>\n          {/* Image END   */}\n\n          {/* Director START  */}\n          <div className=\"six wide column\">\n            <div className={errors.director ? \"field error\" : \"field\"}>\n              <label>Director</label>\n              <input\n                value={data.director}\n                onChange={this.handleStringChange}\n                type=\"text\"\n                name=\"director\"\n                id=\"director\"\n                placeholder=\"film director\"\n              />\n              <FormMessage>{errors.director}</FormMessage>\n            </div>\n          </div>\n          {/* Director END   */}\n\n          {/* Duration START  */}\n          <div className=\"six wide column\">\n            <div className={errors.duration ? \"field error\" : \"field\"}>\n              <label>Duration</label>\n              <input\n                value={data.duration}\n                onChange={this.handleNumberChange}\n                type=\"number\"\n                name=\"duration\"\n                id=\"duration\"\n                placeholder=\"Duration\"\n                min={0}\n              />\n              <FormMessage>{errors.duration}</FormMessage>\n            </div>\n          </div>\n          {/*  Duration END   */}\n\n          {/* Price START  */}\n          <div className=\"six wide column\">\n            <div className={errors.price ? \"field error\" : \"field\"}>\n              <label>Price</label>\n              <input\n                value={data.price}\n                onChange={this.handleNumberChange}\n                type=\"number\"\n                name=\"price\"\n                id=\"price\"\n                placeholder=\"price\"\n              />\n              <FormMessage>{errors.price}</FormMessage>\n            </div>\n          </div>\n          {/*  Price END   */}\n\n          {/* Featured START  */}\n          <div className=\"six wide column inline field\">\n            <label htmlFor=\"featured\">Featured</label>\n            <input\n              onChange={this.handleCheckboxChange}\n              value={data.featured}\n              type=\"checkbox\"\n              name=\"featured\"\n              id=\"featured\"\n              checked={data.featured}\n            />\n          </div>\n          {/*  Featured END   */}\n        </div>\n        {/* ui grid END */}\n\n        {/*  Buttons START */}\n\n        <div className=\"ui fluid buttons px-3\">\n          <button className=\"ui button primary\" type=\"submit\">\n            Save\n          </button>\n          <div className=\"or\"></div>\n          <Link className=\"ui button\" to=\"/films\">\n            Hide form\n          </Link>\n        </div>\n        {/*  Buttons END */}\n      </form>\n    )\n  }\n}\n\nexport default FilmForm\n"]},"metadata":{},"sourceType":"module"}